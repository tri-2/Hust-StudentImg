<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HUST Student Image - Dark Mode</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            text-align: center; 
            padding-top: 50px; 
            background-color: #1a1a1a; /* Màu nền tối */
            color: #e0e0e0; /* Màu chữ sáng */
            margin: 0;
        }

        .container { 
            background: #2d2d2d; 
            padding: 30px; 
            border-radius: 12px; 
            display: inline-block; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.5); 
            border: 1px solid #444;
        }

        h2 { color: #ff4d4d; margin-bottom: 20px; }

        input { 
            padding: 12px; 
            width: 220px; 
            border: 1px solid #555; 
            border-radius: 6px; 
            background-color: #3d3d3d; 
            color: white;
            outline: none;
            transition: border 0.3s;
        }
        input:focus { border-color: #ff4d4d; }

        button { 
            padding: 12px 24px; 
            background-color: #c02135; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: bold;
            transition: background 0.3s, transform 0.1s;
        }
        button:hover { background-color: #e60000; }
        button:active { transform: scale(0.95); }

        #result { margin-top: 30px; min-height: 200px; }
        img { 
            max-width: 320px; 
            border: 4px solid #444; 
            border-radius: 8px; 
            display: none; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        #loading { color: #aaa; font-style: italic; display: none; }
        .error { color: #ff6666; margin-top: 15px; display: none; font-weight: bold; }
        
        .footer { margin-top: 20px; font-size: 0.8em; color: #666; }
    </style>
</head>
<body>

<div class="container">
    <h2>HUST Student Image</h2>
    <input type="text" id="mssvInput" placeholder="Nhập MSSV..." onkeyup="checkEnter(event)">
    <button onclick="viewImage()">Xem ảnh</button>
    
    <div id="result">
        <p id="loading">Đang kết nối tới máy chủ...</p>
        <img id="studentImg" src="" alt="Ảnh sinh viên">
        <p id="errorMsg" class="error">MSSV không chính xác</p>
    </div>
    <div class="footer">LMT</div>
</div>

<script>

async function fetchImg() {
    const id = document.getElementById('mssv').value.trim();
    const img = document.getElementById('avatar');
    const err = document.getElementById('msg');
    const ld = document.getElementById('loading');

    if (!id) return;

    img.style.display = 'none';
    err.style.display = 'none';
    ld.style.display = 'block';

    try {
        const p = "https://api.allorigins.win/get?url=";
        const t = encodeURIComponent(`https://ctsv.hust.edu.vn/ctsv-img/getimagebystudentid?mssv=${id}&mssv=${id}`);
        
        const res = await fetch(p + t);
        const js = await res.json();
        const b64 = js.contents.replace(/"/g, '');

        if (b64 && b64 !== "chua co anh") {
            img.src = "data:image/jpeg;base64," + b64;
            img.style.display = 'block';
        } else {
            err.style.display = 'block';
        }
    } catch (e) {
        err.style.display = 'block';
    } finally {
        ld.style.display = 'none';
    }
}
</body>

</html>

